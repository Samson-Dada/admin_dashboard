import{r as l,u as j,j as e,L as m,O as T,R as N,B as w,C as v,X as E,Y as S,T as L,a as R,b as P,c as $,d as Y,e as h,N as J,f as M}from"./vendor-2PXX9EGo.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function d(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=d(r);fetch(r.href,a)}})();const b={API_LOCAL_BASE_URL:"http://127.0.0.1:8000/api",DEPLOYED_API_BASE_URL:"https://backend-service-6nog.onrender.com/api"},D="admin",A=b.DEPLOYED_API_BASE_URL,K=async t=>{try{const s=await fetch(`${A}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Login failed");return await s.json()}catch(s){throw console.error("Error during login:",s),s}},z=async t=>{try{const s=await fetch(`${A}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Login failed");return await s.json()}catch(s){throw console.error("Error during login:",s),s}},X=()=>{const[t,s]=l.useState(""),[d,o]=l.useState(""),r=j(),a=async n=>{n.preventDefault();const p={email:t,password:d};try{const c=await K(p),x=c.data.user.role??"";if(x){console.log("Login successful:",c);const g=c.data.token;localStorage.setItem("token",g);const f={id:c.data.user._id,role:c.data.user.role,fullName:c.data.user.fullName,email:c.data.user.email};localStorage.setItem("userInfo",JSON.stringify(f)),console.log("User info stored successfully."),x==="admin"?(r("/admin/dashboard"),r("/admin")):r("/user/home")}else console.error("Unauthorized access.")}catch(c){console.error("Login failed:",c)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Login"}),e.jsxs("form",{onSubmit:a,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your email",value:t,onChange:n=>s(n.target.value),required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700",children:"Password"}),e.jsx("input",{type:"password",id:"password",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your password",value:d,onChange:n=>o(n.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition duration-200",children:"Login"})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("span",{children:"Register as admin "}),e.jsx(m,{to:"/register",className:"text-blue-500 hover:underline",children:"Sign Up"})]})]})})},G=()=>{const[t,s]=l.useState(""),[d,o]=l.useState(""),[r,a]=l.useState(""),[n,p]=l.useState(""),[c,x]=l.useState(""),[g,f]=l.useState(""),O=j(),C=async i=>{i.preventDefault();const F={email:t,fullName:d,username:r,phoneNumber:n,password:c,role:g};try{const u=await z(F),y=u.data.user.role??"";if(y===D){console.log("Registration successful:",u);const B=u.data.token;localStorage.setItem("token",B);const q={id:u.data.user._id,role:u.data.user.role,fullName:u.data.user.fullName,email:u.data.user.email};localStorage.setItem("userInfo",JSON.stringify(q)),console.log("User info stored successfully."),O("/admin/dashboard")}else y===""&&console.error("Error: You are not authorized to access this page")}catch(u){console.error("Registration failed:",u)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Register"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"fullName",className:"block text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",id:"fullName",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your full name",value:d,onChange:i=>o(i.target.value),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your email",value:t,onChange:i=>s(i.target.value),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"username",className:"block text-gray-700",children:"Username"}),e.jsx("input",{type:"text",id:"username",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your username",value:r,onChange:i=>a(i.target.value),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700",children:"Phone Number"}),e.jsx("input",{type:"text",id:"phoneNumber",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your phone number",value:n,onChange:i=>p(i.target.value),required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700",children:"Password"}),e.jsx("input",{type:"password",id:"password",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter your password",value:c,onChange:i=>x(i.target.value),required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"role",className:"block text-gray-700",children:"Role"}),e.jsxs("select",{id:"role",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",value:g,onChange:i=>f(i.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a role"}),e.jsx("option",{value:D,children:"Admin"}),e.jsx("option",{value:"user",children:"User"})]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition duration-200",children:"Register"})]})]})})},H=()=>{const t=j(),s=()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),t("/login")};return e.jsx("aside",{className:"w-64 h-screen bg-gray-800 p-5 text-white",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Admin Dashboard"}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(m,{to:"/admin/dashboard",className:"text-white hover:text-gray-300",children:"Dashboard"})}),e.jsx("li",{children:e.jsx(m,{to:"/admin/users",className:"text-white hover:text-gray-300",children:"Manage Users"})}),e.jsx("li",{children:e.jsx(m,{to:"/products",className:"text-white hover:text-gray-300",children:"Products"})})]}),e.jsxs("div",{className:"mt-10",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-4",children:"Authentication"}),e.jsx("ul",{className:"space-y-4",children:e.jsx("li",{children:e.jsxs("button",{onClick:s,className:"w-20 flex items-center justify-center bg-red-500 px-4 py-2 rounded hover:bg-red-600 transition duration-200",children:[e.jsx("i",{className:"icon-logout mr-2"})," Logout"]})})})]})]})})},Q=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(H,{}),e.jsxs("div",{className:"flex-grow bg-gray-50 p-4",children:[e.jsx(T,{})," "]})]}),I=JSON.parse(localStorage.getItem("userInfo"));console.log("role",I);const _=b.DEPLOYED_API_BASE_URL,k=async()=>{try{const t=await fetch(`${_}/users`);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){console.error("There was a problem with the fetch operation:",t)}},V=async t=>{const s=await fetch(`${_}/users/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Role:I.role}});if(s.status!==204){if(!s.ok)throw new Error("Failed to delete user");return await s.json()}},W=b.DEPLOYED_API_BASE_URL,Z=async()=>{try{const t=await fetch(`${W}/products`);if(!t.ok)throw new Error("Failed to fetch product data");return await t.json()}catch(t){throw console.error("Error fetching products:",t),t}},U=()=>{const[t,s]=l.useState([]),[d,o]=l.useState([]);return l.useEffect(()=>{(async()=>{try{const a=await k(),n=await Z();s([{name:"Users",value:a.length}]),o([{name:"Products",value:n.length}])}catch(a){console.error("Error fetching data:",a)}})()},[]),e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Number of Users"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(w,{data:t,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(E,{dataKey:"name"}),e.jsx(S,{}),e.jsx(L,{}),e.jsx(R,{}),e.jsx(P,{dataKey:"value",fill:"#8884d8"})]})})]}),e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Number of Products"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(w,{data:d,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(E,{dataKey:"name"}),e.jsx(S,{}),e.jsx(L,{}),e.jsx(R,{}),e.jsx(P,{dataKey:"value",fill:"#82ca9d"})]})})]})]})]})},ee=()=>{const[t,s]=l.useState([]);l.useEffect(()=>{(async()=>{try{const r=await k();r&&r.filteredRole&&Array.isArray(r.filteredRole)?s(r.filteredRole):console.error("FilteredRole is not an array or missing")}catch(r){console.error("Error fetching data:",r)}})()},[]);const d=async o=>{if(window.confirm("Are you sure you want to delete this user?"))try{const r=await V(o);console.log("response",r);const a=t.filter(n=>n._id!==o);s(a),alert("User deleted successfully.")}catch(r){console.error("Error deleting user:",r),alert("Failed to delete user. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-5",children:e.jsxs("div",{className:"bg-white p-6 rounded-md shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Manage Users"}),e.jsx(m,{to:"/admin/users/create",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition duration-200",children:"Create User"})]}),e.jsxs("table",{className:"w-full bg-white rounded shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-left",children:[e.jsx("th",{className:"py-2 px-4",children:"Name"}),e.jsx("th",{className:"py-2 px-4",children:"Email"}),e.jsx("th",{className:"py-2 px-4",children:"Role"}),e.jsx("th",{className:"py-2 px-4",children:"Actions"})]})}),e.jsx("tbody",{children:t.length>0?t.map(o=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 px-4",children:o.fullName}),e.jsx("td",{className:"py-2 px-4",children:o.email}),e.jsx("td",{className:"py-2 px-4",children:o.role}),e.jsxs("td",{className:"py-2 px-4 flex space-x-2",children:[e.jsx(m,{to:`/admin/users/edit/${o._id}`,className:"bg-yellow-500 text-white px-4 py-1 rounded hover:bg-yellow-600 transition duration-200",children:"Edit"}),e.jsx("button",{onClick:()=>d(o._id),className:"bg-red-500 text-white px-4 py-1 rounded hover:bg-red-600 transition duration-200",children:"Delete"})]})]},o._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"py-2 px-4 text-center",children:"No users available"})})})]})]})})},se=({children:t})=>{const s=JSON.parse(localStorage.getItem("userInfo"));return s&&s.role==="admin"?t:e.jsx(J,{to:"/login"})};function re(){return l.useState([]),e.jsx($,{children:e.jsxs(Y,{children:[e.jsxs(h,{path:"/admin",element:e.jsx(se,{children:e.jsx(Q,{})}),children:[e.jsx(h,{index:!0,element:e.jsx(U,{})}),e.jsx(h,{path:"dashboard",element:e.jsx(U,{})}),e.jsx(h,{path:"users",element:e.jsx(ee,{})})]}),e.jsx(h,{path:"/login",element:e.jsx(X,{})}),e.jsx(h,{path:"/register",element:e.jsx(G,{})})]})})}M(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(re,{})}));
